<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Kindle Promotion">
  <meta name="author" content="Siqi Li">
  <title>Kindle Promotion</title>
  <link href = "static/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel = "stylesheet" type = "text/css"/>
  <link href = "static/assets/global/css/components.css" rel = "stylesheet" type = "text/css"/>
  <link href = "static/assets/admin/pages/css/login.css" rel = "stylesheet" type = "text/css"/>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,700" rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="static/assets/global/css/main.css">
  <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
  <script src="static/assets/global/plugins/jquery-1.11.0.min.js" type = "text/javascript"></script>
  <script src="gethost.js" type = "text/javascript"></script>
  <style>
    body, h1, h2, h3, h4, h5 {
      font-family: "Raleway", sans-serif;
      border:0px solid
    }
    table {
      border:0px solid
    }
  </style>
  <link rel="stylesheet" href="static/assets/global/css/main.css">
</head>

<body>
<header class="top-header" style="background-color: #434343">
  <nav class="top-nav">
    <a href="https://github.com/siqi-ontheway/aws-hackathon-2021">Home</a>
    <a href="https://www.amazon.com/Amazon-Devices/b?ie=UTF8&node=2102313011">Contact</a>

  </nav>
  <span id="welcome-msg" >Welcome user!</span>
</header>
<div class = "content" style ="margin: 0px auto;
         overflow: auto;
         padding: 40px">
  <h3 class = "form-title" id = "list">
    <header>
    <p>
      <span>Kindle Book</span>
      <br/> List
    </p>
  </header>
  </h3>


  <section class="main-section">


    <aside id="item-nav">
      <div class="nav-icon">
        <i class="fa fa-sitemap fa-2x"></i>
      </div>
      <nav class="main-nav">
        <a href="#" id="promo-btn" class="main-nav-btn active">
          <i class="fa fa-fire"></i> Best Seller
        </a>
        <a href="#" id="book-btn" class="main-nav-btn">
          <i class="fa fa-book"></i> All Books
        </a>
      </nav>
    </aside>

    <div id ="item-list" class = "table-responsive" style="color: #624630">
      <table class = "table" id="itable">
        <thead style ="background-color: #434343;color:whitesmoke">
        <tr>
          <th>Title</th>
          <th>Image</th>
          <th>Description</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Sales</th>
        </tr>
        </thead>
        <tbody id="container" style ="background-color: white;font-size: medium;overflow-y: auto">

        </tbody>
      </table>
    </div>
  </section>
</div>
</body>
<footer style = "font-size: small">
  <p class="panel-title">What We Do</p>
  <p>"Help You Get the Latest Kindle Book Promotions"</p>
  <ul>
    <li>
      <p><i class="fa fa-map-o fa-2x"></i></p>
      <p>
        <a href = 'https://www.amazon.com/Amazon-Devices/b?ie=UTF8&node=2102313011'>Kindle</a>
      </p>
    </li>
    <li>
      <p><i class="fa fa-envelope-o fa-2x"></i></p>
      <p>
        <a href = 'https://github.com/siqi-ontheway/aws-hackathon-2021'>AWS Hackathon 2021</a>
      </p>
    </li>
    <li>
      <p><i class="fa fa-phone fa-2x"></i></p>
      <p>+1 800 123 456</p>
    </li>
  </ul>
</footer>
<script>
  var g_itemList = {},
          oNavBtnList = document.getElementsByClassName('main-nav-btn'),
          oBookBtn = document.getElementById('book-btn'),
          oPromoBtn = document.getElementById('promo-btn'),
          sta = 2;
  oBookBtn.addEventListener('click', loadBooks, false);
  oPromoBtn.addEventListener('click', loadPromos, false);
  function loadBooks() {
    // active side bar buttons
    activeBtn('book-btn');
    sta = 1;
    serverExecutor();
  }
  function loadPromos() {
    // active side bar buttons
    activeBtn('promo-btn');
    sta = 2;
    serverExecutor();
  }
  jQuery(document).ready(function() {
    serverExecutor();
  });

  function serverExecutor() {
    $.ajax({
      type:"GET",
      contentType:"application/x-www-form-urlencoded",
      url : "http://"+g_host+"/item/list",
      xhrFields:{withCredentials:true},
      success:function(data){
        if(data.status =="success"){
          g_itemList = data.data;
          reloadDom();
        } else {
          alert("Fetch Items Failed! " + data.data.errMsg);
        }
      },
      error:function(data){
        alert("Fetch Items failed! " + data.responseText);
      }
    });
  }
  function reloadDom(){
    $("#container").empty();
    g_itemList.sort((a, b) => b.sales - a.sales);
    if(sta == 1) {
      for (var i = 0; i < g_itemList.length ; i++) {
        var itemVO = g_itemList[i];

        var dom = "<tr data-id='" + itemVO.id + "' id='itemDetail" + itemVO.id + "'><td>" + itemVO.title + "</td><td><img style='width:100px;height:auto;' src = '" + itemVO.imgUrl + "'/></td><td>" + itemVO.description + "</td><td>" + itemVO.price + "</td><td>" + itemVO.stock + "</td><td>" + itemVO.sales + "</td></tr>";
        $("#container").append($(dom));
        $("#itemDetail" + itemVO.id).on("click", function (e) {
          window.location.href = "getitem.html?id=" + $(this).data("id");
        })
      }
    } else {
      for (var i = 0; i < Math.min(3,g_itemList.length) ; i++) {
        var itemVO = g_itemList[i];

        var dom = "<tr data-id='" + itemVO.id + "' id='itemDetail" + itemVO.id + "'><td>" + itemVO.title + "</td><td><img style='width:100px;height:auto;' src = '" + itemVO.imgUrl + "'/></td><td>" + itemVO.description + "</td><td>" + itemVO.price + "</td><td>" + itemVO.stock + "</td><td>" + itemVO.sales + "</td></tr>";
        $("#container").append($(dom));
        $("#itemDetail" + itemVO.id).on("click", function (e) {
          window.location.href = "getitem.html?id=" + $(this).data("id");
        })
      }
    }

  }
  function activeBtn(btnId) {
    let len = oNavBtnList.length;
    for (let i = 0; i < len; i++) {
      oNavBtnList[i].className = 'main-nav-btn';
    }
    let btn = document.getElementById(btnId);
    btn.className += ' active';
  }

</script>




</html>















